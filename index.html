<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Gravity Flip</title>
    <style>
        body { margin: 0; overflow: hidden; background: #000; font-family: 'Courier New', Courier, monospace; touch-action: none; }
        canvas { display: block; }
        #ui { position: absolute; top: 20px; left: 50%; transform: translateX(-50%); color: #0f0; font-size: 30px; text-shadow: 0 0 10px #0f0; pointer-events: none; }
    </style>
</head>
<body>
    <div id="ui">Score: <span id="score">0</span></div>
    <canvas id="gameCanvas"></canvas>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        const scoreElement = document.getElementById('score');

        let score = 0;
        let gameActive = true;
        let speed = 5;
        let obstacles = [];
        
        // Настройки игрока
        const player = {
            x: 50,
            y: 0,
            size: 30,
            gravity: 0.6,
            velocity: 0,
            onCeiling: false,
            color: '#0f0'
        };

        function resize() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            player.y = canvas.height - player.size - 20; // Начальная позиция на полу
        }
        window.addEventListener('resize', resize);
        resize();

        function spawnObstacle() {
            const isCeiling = Math.random() > 0.5;
            obstacles.push({
                x: canvas.width + 100,
                y: isCeiling ? 0 : canvas.height - 60,
                w: 40,
                h: 60,
                color: '#f00'
            });
        }

        let frame = 0;
        function update() {
            if (!gameActive) return;

            ctx.fillStyle = '#000';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            // Рисуем "коридор" (линии пола и потолка)
            ctx.strokeStyle = '#333';
            ctx.lineWidth = 4;
            ctx.strokeRect(0, 0, canvas.width, canvas.height);

            // Игрок: физика гравитации
            if (player.onCeiling) {
                player.velocity -= player.gravity;
                if (player.y <= 0) {
                    player.y = 0;
                    player.velocity = 0;
                }
            } else {
                player.velocity += player.gravity;
                if (player.y >= canvas.height - player.size) {
                    player.y = canvas.height - player.size;
                    player.velocity = 0;
                }
            }
            player.y += player.velocity;

            // Рисуем игрока
            ctx.shadowBlur = 15;
            ctx.shadowColor = player.color;
            ctx.fillStyle = player.color;
            ctx.fillRect(player.x, player.y, player.size, player.size);
            ctx.shadowBlur = 0;

            // Препятствия
            if (frame % 80 === 0) spawnObstacle();
            frame++;

            for (let i = obstacles.length - 1; i >= 0; i--) {
                let o = obstacles[i];
                o.x -= speed;

                ctx.fillStyle = o.color;
                ctx.fillRect(o.x, o.y, o.w, o.h);

                // Проверка столкновения
                if (player.x < o.x + o.w &&
                    player.x + player.size > o.x &&
                    player.y < o.y + o.h &&
                    player.y + player.size > o.y) {
                    gameActive = false;
                    alert("Game Over! Score: " + score);
                    location.reload();
                }

                if (o.x < -100) {
                    obstacles.splice(i, 1);
                    score++;
                    scoreElement.innerText = score;
                    if (score % 10 === 0) speed += 0.5; // Ускорение каждые 10 очков
                }
            }

            requestAnimationFrame(update);
        }

        // Переворот гравитации по клику
        window.addEventListener('pointerdown', () => {
            player.onCeiling = !player.onCeiling;
        });

        update();
    </script>
</body>
</html>